``` bash
pip install yfinance pandas sqlalchemy numpy scikit-learn matplotlib seaborn torch torchvision
```

# Apple Stock Price Analysis and Prediction

This project fetches historical Apple (AAPL) stock data, performs feature engineering, conducts exploratory data analysis (EDA), and builds baseline machine learning models (Random Forest, Linear Regression, LSTM) to predict closing prices and price direction.

## Technologies Used

*   **Python 3.x**
*   **yfinance:** To download historical stock market data.
*   **pandas:** For data manipulation and analysis.
*   **SQLAlchemy:** To interact with the SQLite database.
*   **NumPy:** For numerical operations.
*   **scikit-learn:** For feature scaling, splitting data, and implementing Random Forest, Linear Regression models, and evaluation metrics.
*   **Matplotlib:** For generating plots.
*   **PyTorch:** For building and training the LSTM neural network.
*   **SQLite:** As the database to store stock data and features.

## Project Workflow & Usage

The project consists of several scripts that should ideally be run in order:

1.  **`1_create_database.py`**: Downloads historical AAPL stock data from Yahoo Finance using `yfinance` and stores the raw price/volume data into an SQLite database (`stocks.db`) in the `apple_stock_prices` table.
2.  **`2_calculate_features.py`**: Reads the raw data from `stocks.db`, calculates technical indicators (Moving Averages, Volatility, RSI), and saves the data along with these features into a new table `apple_features` in the same database.
3.  **`3_create_plots.py`**: Performs basic Exploratory Data Analysis (EDA) on the raw stock data, generating and saving plots for closing price, volume, and a correlation matrix (`.png` files).
4.  **`4_prediction_model.py`**: Trains a Random Forest Regressor model using the features from `apple_features` to predict the *next day's closing price*. It evaluates the model using RMSE, MAE, and R² score and saves a plot comparing actual vs. predicted prices (`rf_predicted_vs_actual.png`).
5.  **`5_predict_price_direction.py`**: Trains a Random Forest Classifier to predict whether the stock price will go *up or down* the next day based on the features. It prints a classification report and confusion matrix. It also trains a simple Linear Regression model for comparison and prints its RMSE and R² score.
6.  **`6_lstm_prediction.py`**: Implements an LSTM (Long Short-Term Memory) neural network using PyTorch to predict the *next day's closing price*. It preprocesses the data into sequences, trains the model, evaluates it using RMSE and R² score, and saves a plot comparing actual vs. predicted prices (`plots/lstm_predicted_vs_actual.png`).


## Outputs ##

* stocks.db: SQLite database containing raw stock data and calculated features.
* Console Output: Prints from each script, including data previews, training progress, and model evaluation metrics (RMSE, MAE, R², Classification Report).
* .png files: Plots generated by 3_create_plots.py, 4_prediction_model.py, and 6_lstm_prediction.py showing price trends, correlations, and model predictions.


-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------

✅ Built a Complete End-to-End ML Pipeline

* Real-world data acquisition (from yfinance)
* Data engineering (moving averages, RSI, volatility)
* Used both SQL and Pandas
* Developed and compared classification and regression models
* Built a deep learning LSTM model from scratch
* Generated performance metrics and visualizations
* Practiced debugging, troubleshooting, and working with PyTorch/WSL